%--------------------------------------------------------------------------
%   W = word(N, theta_tgt, window_N, lamda, position, theta_jam)
%--------------------------------------------------------------------------
%   功能：
%   正交投影加宽零陷抗干扰
%--------------------------------------------------------------------------
%   输入:
%           N                       阵元数
%           theta_tgt               波束指向 度
%           window_N                指向加窗
%           lambda                  波长
%           position                阵列坐标
%           theta_jam               干扰来向
%   输出：
%           W                       加权系数
%--------------------------------------------------------------------------
%   例子:
%   N = 64; 
%   lambda = 1;                                                             %波长
%   dd = lambda/2;                                                          %阵元间距d = lambda/2
%   d = 0:dd:(N-1)*dd;                                                      %构建阵列坐标
%   W= word( 64, 0,@taylorwin, lambda, d, theta_jam);                       %生成权系数
%--------------------------------------------------------------------------
function  W = word(N, theta_tgt, window_N, lamda, position, theta_jam)
%--------------------------------------------------------------------------
%   指向角的导向矢量
%--------------------------------------------------------------------------
As = window_N(N).* ...
     exp(1j*2*pi*position*sind(theta_tgt)/lamda).'; 
 
%--------------------------------------------------------------------------
%   生成单位阵
%--------------------------------------------------------------------------
In= eye( N);
Ai = [Ai exp( 1j* 2* pi* position* sind( theta_jam(idx))/ lamda).'];

%--------------------------------------------------------------------------
%   干扰来向构造矩阵
%--------------------------------------------------------------------------
P =  In - Ai*( Ai'* Ai)^-1*Ai';                                             %干扰来向的投影矩阵的 正交子空间
W_temp=(As'*P)';
W= W_temp/sqrt( W_temp'* W_temp);                                           %归一化
