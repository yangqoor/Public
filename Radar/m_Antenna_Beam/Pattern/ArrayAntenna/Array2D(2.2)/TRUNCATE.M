      function qph=truncate(nel,bitsize,xsi)%% computes the phase at each array element by truncation% nel elements; nstates phase shifter states; bitsize= size of a phase% bit (rad); xsi= required phase at each element; qph= quantized phase% at each element after truncation.%      for i=1:nel        nsteps=floor((xsi(i)+1.e-4)/bitsize);        xs=nsteps*bitsize;        qph(i)=xs;      end